const http = require("http");

const server = http.createServer((req, res) => {
  // Backend API
  if (req.url === "/api" && req.method === "GET") {
    res.writeHead(200, { "Content-Type": "application/json" });
    res.end(JSON.stringify({ message: "Hello from Backend" }));
  }

  // Frontend HTML
  else {
    res.writeHead(200, { "Content-Type": "text/html" });
    res.end(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Full Stack in One File</title>
      </head>
      <body>
        <h1>Frontend + Backend (Single Code)</h1>
        <button onclick="loadData()">Get Data</button>
        <p id="result"></p>

        <script>
          function loadData() {
            fetch('/api')
              .then(res => res.json())
              .then(data => {
                document.getElementById('result').innerText = data.message;
              });
          }
        </script>
      </body>
      </html>
    `);
  }
});

server.listen(3000, () => {
  console.log("Server running at http://localhost:3000");
});
